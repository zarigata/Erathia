ETHERIA: The Ultimate Open-World RPGENGINE + WORLD PLAN (UPDATED)Codename: Valheim × Minecraft × HoMM × Skyrim Fusion  Engine: Godot 4.3+ / 4.4 (Stable)  Dev Style: AI-First via Google Antigravity + MCP (minimal manual clicking)  Terrain: Smooth voxel SDF terrain (GDVoxelTerrain) with full mining & deformation  World: Very large but finite (Valheim-style scale, not infinite)Table of Contents1.(#0-engine-ai--tooling-decisions)2.(#1-world-scale-voxel-terrain--mining)3.(#2-biomes-factions--non-radial-difficulty)4.(#3-settlements-player-empire--rpg-layer)5. Combat & Encounters6. 7.(#6-lua-modding--steam-workshop)8.(#7-llm-quests--faction-stories)9.(#8-roadmap-to-steam-release)0. ENGINE, AI & TOOLING DECISIONS0.1 Engine Choice: Godot + MCPWhy Godot over Unity given Antigravity + MCP:Voxel Plugins:Zylann/godot_voxel — Blocky + smooth terrain, LOD, instancing. Selected for ETHERIA due to superior foliage (VoxelInstancer) support. [1]JorisAR/GDVoxelTerrain — Smooth SDF terrain (octree + surface nets, good LOD)MCP Tooling:Godot MCP / GDAI MCP — MCP servers that let AI agents (Antigravity, Cursor, VSCode, etc.) create scenes, scripts, run projects, and manage assets from outside the editorDECISION: Use Godot 4.3+ or 4.4 + Godot MCP server so Google Antigravity can drive the project almost hands‑free.0.2 Project Layout (for AI Agents)Directory layout optimised for MCP/agents:res://├── _core/          # GameManager, SaveManager, EventBus, Time, Weather├── _engine/        # Voxel, worldgen, pathfinding, ECS-style systems├── _player/        # Player controller, camera, tools, stats├── _world/         # Biomes, Factions, Regions, POI, Dungeons├── _building/      # Build pieces, snap system, integrity├── _rpg/           # Skills, perks, combat, crafting, loot├── _ai/            # LLM bridge, companions, NPC brains, behavior trees├── _mods/          # Lua runtime, mod loader, public APIs├── _ui/            # HUD, menus, dialogue, map└── _assets/        # Models, textures, sounds, VFXAI Agent Instruction Example:  "Create res://_world/biomes/biome_manager.gd implementing the biome lookup interface"0.3 Core Tech Stack1. WORLD SCALE, VOXEL TERRAIN & MINING1.1 World ScaleWorld Type: Finite world (not infinite)1.2 Terrain Engine (Godot Voxel Setup)SDF-Based Smooth Terrain:Store terrain in an octree SDF (density function)Mesh terrain via Transvoxel (Seamless LOD transitions) [1]Configuration:1.3 Mining & Terrain Deformation (FIXED)Fix for "Broken Mining": Previous issues likely stemmed from using Physics Raycasts which are asynchronous (laggy). We must use VoxelTool.raycast which reads the SDF data directly.Technical Implementation of Tools:1. The Pickaxe (Sharp Cuts)Logic: Uses VoxelTool on CHANNEL_SDF.Operation: do_box (Subtract) aligned to grid.Value: sdf_scale = 1.0 (Hard air).Grid Snapping: Rounds hit position to nearest integer to prevent "rounded corners" or floating artifacts. [2]2. The Shovel (Organic Sculpting)Logic: Uses VoxelTool on CHANNEL_SDF.Operation: do_sphere (Add/Subtract).Value: sdf_scale = 0.5 (Softer gradient for smooth slopes).Target: Uses tool.raycast(origin, direction) to find exact surface intersection, ignoring physics mesh lag. [3]3. The Hoe (Flattening)Logic: VoxelTool.smooth_sphere or VoxelTool.flatten (Custom script).Effect: Averages SDF values in a radius to create building pads.1.4 Vegetation & Destructible FoliageProblem: "Bland terrain."Solution: Use VoxelInstancer for massive density (Grass/Bushes) + "Instance Swapping" for interactable Trees. [4]Foliage Layers (VoxelInstanceLibrary):The "Chop-Down" Tech (Instance Swapping):Rendering: Trees are rendered via GPU (VoxelInstancer) for performance. They are not Nodes.Detection: When player swings Axe, raycast against the VoxelInstancer.Swap:Identify Instance ID at hit location.Remove Instance from Voxel Data (VoxelInstancer.remove_instance). [4]Spawn a temporary RigidBody3D (Falling Tree Log) at that position.Player chops the RigidBody into wood items.2. BIOMES, FACTIONS & NON-RADIAL DIFFICULTY2.1 The "Mindset" Map (Deterministic Generation)Fix for "Random Stuff": We will not rely on pure Perlin noise. We will generate a Voronoi Biome Map image first. [5, 6]Pre-Generation Step (The "Mindset"):Before the game starts, run a MapGenerator script:Seeds: Place 10-15 "Faction Capitals" on a 2048x2048 grid.Voronoi: Calculate regions based on distance to these capitals.Output: Save an Image resource where:Red Channel: Biome ID.Green Channel: Faction ID.Blue Channel: Elevation Control (Mountains vs Plains).Biome Integration in Voxel Graph:The VoxelGeneratorGraph will read this Image.Input: World (x, z) coordinates.Logic: Sample the Image. If Red=1 (Forest), use ForestNoise settings. If Red=2 (Desert), use DesertNoise settings. [7]2.2 Biome List (Updated for Assets)Using standard Low Poly assets (Quaternius/KayKit) to fix "blandness":2.3 Faction-Biome BindingKey Rule: A faction is 100% tied to the biome(s) it owns. No conquest outside those biome types (for now).Generation Steps:Step 1: Biome PassFor each chunk, compute biome according to noise + altitudeStep 2: Faction Suitability PassEach faction has a list of allowed biomes (Based on HoMM3 Archetypes):Candidate "region centers" (towns, villages, castles) are chosen based on:Flatness / proximity to waterAccess to local resources (wood, ore, farmland)Step 3: Faction Claim PassWhen a region is selected for a faction:Mark a radius (e.g., 500–1500m) as owned territory of that factionBiome variant is switched from neutral to faction variant:  - Color grading, banners, building kits  - Extra plants/resources specific to that factionUnclaimed Biome Areas:Same biome, but:  - No castles/towns  - Weaker or "untamed" monsters  - More opportunity for player settlement2.4 Deep Reputation & DiplomacyReputation is Non-Exclusive. You can befriend multiple factions if you play your cards right ("Double Agent").1. Independent Tracks (0–100)Every faction has its own 0-100 meter for the player.  0-20 (Hostile): Kill on Sight. Gates closed. No quests.  20-40 (Cold): Tolerated. Allowed in outer villages. High prices.  40-60 (Neutral): Standard access. Normal trade. Basic quests.  60-80 (Friendly): Access to inner keeps. Better prices. Military support.  80-100 (Exalted): Grant Faction Core (for Crafting). Can command local armies.2. Balancing Act (The "Diplomat" Game)  Cross-Faction Quests: Some quests help Faction A without hurting Faction B (e.g., "Kill neutral monsters threatening the border").  Secret Ops: Stealth missions to help a faction without being seen (preserves rep with the victim).  Consequences: If Rep drops below 10, they send assassins. If Rep is >80, they send gifts/resources daily.2.5 Dynamic Difficulty & Affinity SystemDifficulty is dynamically calculated based on Player Level, Faction Affinity, and Biome Rules.1. Player Level & ProgressionDifficulty scales with the player's level.Higher level players trigger tougher enemy spawns and smarter AI.2. Faction Affinity (Tools & Equipment)Tools determine power: Some magic/tools are exclusive to certain factions.Affinity: Player's equipment (clothes, wands, weapons) affects their power in specific biomes.  - Example: Using Nature magic items in a Necropolis zone is ineffective.3. Biome-Faction Interaction Matrix (The "Zone" System)Every biome has Intrinsic properties that buff its native faction and strictly punish its Rival Faction. Magic rules change drastically per zone.Exclusive Tools & Affinity:  Angel Wings (Castle): Fly over lava (Inferno).  Elven Cloak (Rampart): Invisible in Forest.  Shackles of War (Stronghold): Prevents enemy retreat; suppresses all Magic in radius.  Gas Mask / Plague Doctor Set (Neutral/Tower): Required to survive in Necropolis/Swamp for long periods.  Magma Boots (Inferno): Walk on Lava.Tactical Layer: You must drag a Necropolis army into the Forest to weaken them, or lure Elves into the Deadlands to crush them.BiomeDanger (0.5–4.0):FactionPower (0.7–1.5):LocalEvents:Result: You can have "easy" zones at the edges (calm plains near ocean). A nearby volcanic fortress might be extremely hard even if it's close to the starting area.3. SETTLEMENTS, PLAYER EMPIRE & RPG LAYER3.1 Player Settlements → EmpirePlayer can place a Settlement Stone to found a village.Settlement Progression:Systems:Faction Reactions:Factions react based on territory overlap + reputationBuilding on faction land while hated = raids/attacksAs emperor you can have vassal factions later (future feature)3.2 Tiered Crafting System & Tech Tree (Phase 4.5)Crafting progresses from basic survival to high-fantasy faction technology. The highest tier allows mixing powerful Faction Magic.The Union Station (Super Crafting Table):This is a unique, global late-game station.  Mechanic: It has slots for Faction Cores.  Unlocking Cores: You gain a Faction's Core only by reaching "Exalted" status dealing with them.  Power-Ups: Inserting a Necropolis Core allows crafting generic items with Vampirism. Inserting an Inferno Core allows crafting Magma Boots. Inserting BOTH allows crafting a Vampiric Flame Sword.3.3 Skyrim-Style Skills & Perks (Usage-based)5 Skill Categories:Fully integrated with mining & building.XP Sources:Skills like Mining, Woodcutting, Building gain XP from:Terrain editsResource gatheringSuccessful structuresPerk Tree Benefits:Faster mining, bigger terrain brushesCheaper building resourcesStronger faction influence4. COMBAT & ENCOUNTERSCombat Mechanics:AI Types:Spawn Logic: Uses difficulty score per region, NOT distance from center.5. AI COMPANIONS, VOICE & LLM5.1 Companion DesignEach companion has:5.2 Command System (Low GPU, Clear Behavior)Commands are separated from free chat. Commands use a cheap, rule-based parser.Command Mapping:Implementation Flow:No need to call LLM if a direct command is detectedCompanion executes using:  - Pathfinding (NavMesh3D)  - Tools to mine wood/stone using the same TerrainEditSystemFree Chat (LLM):Trigger when:Player talks without clear command keywordsPlayer explicitly opens "talk" modeLLM prompt includes:Companion personalityRecent events (combat, crafting, story beats)Current quest context5.3 Event ReactionsCompanions react to:Player low healthBig enemy defeatedEntering new biome/faction territoryLong mining/crafting sessions ("We've been down here for hours…")5.4 Voice & Local/Cloud SettingsAll LLM logic MUST work with local-only if user wants. Cloud is optional.6. LUA MODDING & STEAM WORKSHOP6.1 Lua Modding ArchitectureUse Lua GDExtension or LuaAPI to create sandboxed Lua states.Mod Loader:Each mod = folder in res://_mods/ with mod.lua manifestExample Mod API:Available Hooks:6.2 Steam Workshop Integration (Later Phase)"Mods" Menu Features:Browse local modsSync with Steam Workshop (subscribe/unsubscribe)Auto-load all enabled mods on bootAPI Versioning:7. LLM QUESTS & FACTION STORIESQuest System Design:LLM Quest Templates:Fetch, defend, escort, explore, diplomacy, tradeLLM Fills:Names, flavor text, alternative branchesFaction Capabilities:Request resources, alliances, duels, tasks based on real game state8. ROADMAP TO STEAM RELEASEMilestone 1: Foundation (Current Focus)Milestone 2: Core GameMilestone 3: Steam ReleasePost LaunchQuick Reference for AI AgentsFile Path Conventions:res://_core/       → Core systems (GameManager, SaveManager, EventBus)res://_engine/     → Voxel and world generationres://_player/     → Player controller and toolsres://_world/      → Biomes and factionsres://_building/   → Build systemres://_rpg/        → Skills and combatres://_ai/         → Companion AI and LLMres://_mods/       → Mod systemres://_ui/         → User interfaceres://_assets/     → Art and audio assetsKey Systems to Implement:Document Version: Updated for AI-First Development (v2)Last Modified: December 2024Target Engine: Godot 4.3+ / 4.4